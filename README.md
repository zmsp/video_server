I didn't write the whole code. 
Initial code was copied form: https://gist.github.com/n3wtron/4624820
